(()=>{var e=document.querySelector('meta[name="base-url"]').getAttribute("content"),t=document.getElementById("exampleModal"),n=document.getElementById("media-container");function i(t,n,a,d,r,o,l){var s=t.slice(a,d),c=new FormData;c.append("file_chunk",s),c.append("index",n),c.append("total_chunks",Math.ceil(t.size/r)),c.append("file_name",t.name);var u=new XMLHttpRequest;u.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;o[n].progressBar.style.width=t+"%",l.style.visibility="visible"}})),u.open("POST","".concat(e,"/app/media-library/upload"),!0),u.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),u.onload=function(){200===u.status&&(JSON.parse(u.responseText).success&&(d<t.size?(a=d,d=Math.min(a+r,t.size),i(t,n,a,d,r,o,l)):(o[n].progressBar.style.width="100%",l.style.visibility="hidden")))},u.send(c)}document.addEventListener("DOMContentLoaded",(function(){var n="",i="",a="",d=0;function r(){document.querySelectorAll('button[data-bs-target="#exampleModal"]').forEach((function(e){!function(e){e.addEventListener("click",(function(){i=this.getAttribute("data-image-container"),a=this.getAttribute("data-hidden-input")}))}(e)}))}function o(e,t){n=e,document.querySelectorAll("#mediaLibraryContent img, #mediaLibraryContent video").forEach((function(e){e.classList.remove("iq-image")})),t.classList.add("iq-image")}if(document.getElementById("mediaLibraryContent")&&document.getElementById("mediaLibraryContent").addEventListener("click",(function(e){if("IMG"===e.target.tagName)o(t=e.target.src,e.target);else if("VIDEO"===e.target.tagName){var t;(t=e.target.querySelector("source").src)&&o(t,e.target),e.preventDefault()}})),document.getElementById("mediaSubmitButton")&&document.getElementById("mediaSubmitButton").addEventListener("click",(function(){if(n&&i&&a){var e=document.getElementById(i),t=document.getElementById(a);if(e){if(t.value=n,e.innerHTML="",t.hasAttribute("data-validation")){var d=document.getElementById("file-error"),r=document.querySelector('input[name="video_file_input"]'),o=document.querySelector('input[name="image_input4"]');if(n.endsWith(".mp4")||n.endsWith(".avi")){d&&(d.style.display="none"),r&&r.removeAttribute("required");var l=document.createElement("video");l.src=n,l.controls=!0,l.classList.add("img-fluid","mb-2"),l.style.maxWidth="300px",l.style.maxHeight="300px",e.appendChild(l),(s=document.createElement("span")).innerHTML="&times;",s.classList.add("remove-media-icon"),s.style.cursor="pointer",s.style.fontSize="24px",s.style.position="absolute",s.addEventListener("click",(function(){e.innerHTML="",t.value="",r&&(r.value=""),o&&o.setAttribute("required","required"),d&&(d.style.display="block")})),o&&o.removeAttribute("required"),e.appendChild(s)}else{r&&r.setAttribute("required","required"),d&&(d.style.display="block"),(u=document.createElement("div")).classList.add("text-danger"),u.textContent="Only video files are allowed.",e.appendChild(u)}}else if(n.endsWith(".png")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".webp")){var s,c=document.createElement("img");c.src=n,c.classList.add("img-fluid","mb-2"),c.style.maxWidth="100px",c.style.maxHeight="100px",e.appendChild(c),(s=document.createElement("span")).innerHTML="&times;",s.classList.add("remove-media-icon"),s.style.cursor="pointer",s.style.fontSize="24px",s.addEventListener("click",(function(){e.innerHTML="",t.value=""})),e.appendChild(s)}else{var u;(u=document.createElement("div")).classList.add("text-danger"),u.textContent="Only image files are allowed.",e.appendChild(u),document.querySelectorAll(".input-group-text.form-control").forEach((function(e){e&&(e.innerHTML="")}))}$("#exampleModal").modal("hide")}}})),document.getElementById("submitButton")){var l=document.getElementById("submitButton");document.getElementById("submitButton").addEventListener("click",(function(t){document.getElementById("media-container");t.preventDefault(),l.disabled=!0,window.uploadedFiles=window.uploadedFiles||[];var n=new FormData,i=window.uploadedFiles.filter((function(e){return!e.removed}));if(i.length>0){document.getElementById("file_url_media").removeAttribute("required"),document.getElementById("file_url_media-error").style.display="none";for(var a=0;a<i.length;a++)n.append("file_url[]",i[a].file);var d=new XMLHttpRequest;d.open("POST","".concat(e,"/app/media-library/store"),!0),d.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),d.onloadstart=function(){l.innerText="Loading..."},d.onload=function(){if(200===d.status){window.uploadedFiles=[],document.getElementById("nav-media-library-tab").click();var e=document.getElementById("media-container");page=1,e.innerHTML="",l.disabled=!1,s(),mediaLibraryContent.addEventListener("scroll",c)}},d.onloadend=function(){l.innerText="Save"},l.disabled=!1,d.send(n)}else document.getElementById("file_url_media").setAttribute("required","required"),document.getElementById("file_url_media-error").style.display="block",l.innerText="Save";l.disabled=!1,window.location.href==="".concat(e,"/app/media-library")&&window.location.reload()}))}function s(){var t=document.getElementById("media-container"),n=(document.getElementById("loading-spinner"),document.getElementById("mediaLibraryContent"),!1),i=!0;!n&&i&&(n=!0,fetch("".concat(e,"/app/media-library/getMediaStore?page=").concat(page,"&perPage=").concat(21)).then((function(e){return e.json()})).then((function(e){e.html?(1===page&&(t.innerHTML=""),t.insertAdjacentHTML("beforeend",e.html),e.hasMore?page++:i=!1):console.log("No data received")})).catch((function(e){return console.error("Error:",e)})).finally((function(){n=!1})))}function c(){mediaLibraryContent.scrollTop+mediaLibraryContent.clientHeight>=mediaLibraryContent.scrollHeight-100&&s()}function u(e){e.find(".video_quality_type").on("change",(function(){var t=$(this).val(),n=e.find(".quality_video_file_input"),i=e.find(".quality_video_input"),a=e.find('input[name="quality_video[]"]'),d=e.find('input[name="quality_video_url_input[]"]');"Local"===t?(n.removeClass("d-none"),i.addClass("d-none"),a.val(a.val()).trigger("change"),d.val("").trigger("change")):(n.addClass("d-none"),i.removeClass("d-none"),d.val(d.val()).trigger("change"),a.val("").trigger("change"))})).trigger("change")}function m(e){e.find("select.select2").each((function(){$(this).select2({width:"100%"})}))}t&&t.addEventListener("hidden.bs.modal",(function(){mediaLibraryContent.removeEventListener("scroll",c)})),$("#add_more_video").click((function(){var e=$(".video-inputs-container").first();e.find("select.select2").each((function(){$(this).data("select2")&&$(this).select2("destroy")}));var t=e.clone();d++,t.find("input, select").each((function(){var e=$(this).attr("id");e&&$(this).attr("id",e+d);var t=$(this).attr("name");t&&$(this).attr("name",t+d),$(this).val("").trigger("change")})),t.find(".remove-video-input").removeClass("d-none"),t.find("[data-image-container]").each((function(){var e=$(this).attr("data-image-container");$(this).attr("data-image-container",e+d)})),t.find("[data-hidden-input]").each((function(){var e=$(this).attr("data-hidden-input");$(this).attr("data-hidden-input",e+d)})),t.find(".img-fluid").remove(),t.find(".remove-media-icon").remove(),t.find('input[type="hidden"]').val(""),t.find("div[id]").each((function(){var e=$(this).attr("id");e&&$(this).attr("id",e+d)})),$("#video-inputs-container-parent").append(t),m(t),u(t),r(),m(e)})),$(document).on("click",".remove-video-input",(function(){$(this).closest(".video-inputs-container").remove()})),$(".video-inputs-container").each((function(){u($(this))})),r(),m($(document))})),document.getElementById("file_url_media")&&document.getElementById("file_url_media").addEventListener("change",(function(){var e=document.getElementById("file_url_media"),t=document.getElementById("uploadedImages"),n=31457280,a=[];if(t.innerHTML="",e.files.length>0)for(var d=0;d<e.files.length;d++){var r=e.files[d],o=Math.min(n,r.size);if(r.type.startsWith("video/")){var l=document.createElement("video");l.src=URL.createObjectURL(r),l.currentTime=1,l.addEventListener("loadeddata",(function(){var e=document.createElement("canvas");e.width=l.videoWidth,e.height=l.videoHeight,e.getContext("2d").drawImage(l,0,0,e.width,e.height);var d=document.createElement("img");d.src=e.toDataURL("image/jpeg"),d.classList.add("img-fluid","iq-uploaded-image"),d.style.width="150px",d.style.height="100px";var s=document.createElement("div");s.classList.add("progress","mb-3","iq-progress"),s.style.visibility="hidden",s.innerHTML='\n                            <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                        ';var u=document.createElement("div");u.classList.add("iq-uploaded-image-close"),u.innerHTML="&times;",u.addEventListener("click",(function(){a[0].removed=!0,this.parentNode.remove(),c()}));var m=document.createElement("div");m.classList.add("iq-uploaded-image-container"),m.appendChild(d),m.appendChild(s),m.appendChild(u),t.appendChild(m),a.push({file:r,removed:!1,progressBar:s.querySelector(".progress-bar")}),i(r,0,0,o,n,a,s)}))}else{var s=new FileReader;s.onload=function(e,d){return function(r){var l=document.createElement("img");l.src=r.target.result,l.classList.add("img-fluid","iq-uploaded-image"),l.style.width="150px",l.style.height="100px";var s=document.createElement("div");s.classList.add("progress","my-3","iq-progress"),s.style.visibility="hidden",s.innerHTML='\n                                <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                            ';var u=document.createElement("div");u.classList.add("iq-uploaded-image-close"),u.innerHTML="&times;",u.addEventListener("click",(function(){a[d].removed=!0,this.parentNode.remove(),c()}));var m=document.createElement("div");m.classList.add("iq-uploaded-image-container"),m.appendChild(l),m.appendChild(s),m.appendChild(u),t.appendChild(m),a.push({file:e,removed:!1,progressBar:s.querySelector(".progress-bar")}),i(e,d,0,o,n,a,s)}}(r,d),s.readAsDataURL(r)}}function c(){a.every((function(e){return e.removed}))&&(e.value=null,a.length=0,document.getElementById("file_url_media").setAttribute("required","required"),document.getElementById("file_url_media-error").style.display="block")}window.uploadedFiles=a})),document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("loading-spinner"),i=document.getElementById("mediaLibraryContent"),a=document.getElementById("media-search"),d=document.getElementById("no_data"),r=1,o=!1,l=!0,s="",c=document.querySelector('meta[name="base-url"]').getAttribute("content");function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";o||!l&&""==t||(o=!0,e.style.display="block",fetch("".concat(c,"/app/media-library/getMediaStore?page=").concat(r,"&query=").concat(encodeURIComponent(t))).then((function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((function(e){e.html?(d.classList.add("d-none"),n.insertAdjacentHTML("beforeend",e.html),r++,!1):(n.innerHTML="",d.classList.remove("d-none"),$("#no_data").text("No data available")),l=e.hasMore})).catch((function(e){console.error("Error loading images:",e)})).finally((function(){o=!1,e.style.display="none"})))}function m(){i.scrollTop+i.clientHeight>=i.scrollHeight-100&&u(s)}a&&a.addEventListener("input",(function(){s=a.value,r=1,n.innerHTML="",u(s)}));var v=document.getElementById("clear-search");function p(){a&&(a.value.length>0?v.classList.remove("d-none"):v.classList.add("d-none"))}a&&a.addEventListener("input",p),v&&v.addEventListener("click",(function(){a.value="",p(),r=1,s="",o=!1,l=!0,n.innerHTML="",u(s)})),p(),t&&(t.addEventListener("shown.bs.modal",(function(){0===n.children.length&&u(s),i.addEventListener("scroll",m)})),t.addEventListener("hidden.bs.modal",(function(){i.removeEventListener("scroll",m)})),0===n.children.length&&u(s))})),document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("nav-upload-files-tab"),t=document.getElementById("nav-media-library-tab"),n=document.getElementById("media-search-container");if(t){var i=function(){t.classList.contains("active")?n&&(n.style.display="block"):n&&(n.style.display="none")};i(),e.addEventListener("click",i),t.addEventListener("click",i)}}))})();
//# sourceMappingURL=media.min.js.map